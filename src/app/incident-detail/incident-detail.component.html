<div class="container-fluid">
  <div class="row">
    <mat-tab-group
      mat-stretch-tabs
      animationDuration="2000ms"
      class="example-stretched-tabs mat-elevation-z4"
      [(selectedIndex)]="tabIndex"
    >
      <mat-tab label="{{ 'incidentDetail.label1' | translate | uppercase }}">
        <form [formGroup]="incidentForm" class="mt-3">
          <div class="container-fluid">
            <div class="row">
              <div class="col-6">
                <mat-form-field class="w-100" appearance="fill">
                  <mat-label>{{ "incidentDetail.name" | translate }}</mat-label>
                  <input matInput formControlName="name" />
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field class="w-100" appearance="fill">
                  <mat-label>{{
                    "incidentDetail.nameAsset" | translate
                  }}</mat-label>
                  <input matInput value="{{ asset?.name }}" [readonly]="true" />
                </mat-form-field>
              </div>
              <div class="col-4 switch">
                <mat-label class="me-3">{{
                  "incidentDetail.confidentiality" | translate
                }}</mat-label>
                <mat-slide-toggle
                  formControlName="confidentiality"
                ></mat-slide-toggle>
              </div>
              <div class="col-4 switch">
                <mat-label class="me-3">{{
                  "incidentDetail.integrity" | translate
                }}</mat-label>
                <mat-slide-toggle
                  formControlName="integrity"
                ></mat-slide-toggle>
              </div>
              <div class="col-4 switch">
                <mat-label class="me-3">{{
                  "incidentDetail.availability" | translate
                }}</mat-label>
                <mat-slide-toggle
                  formControlName="availability"
                ></mat-slide-toggle>
              </div>
              <div class="col-lg-12 col-sm-12">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>{{
                    "incidentDetail.description" | translate
                  }}</mat-label>
                  <textarea
                    matInput
                    formControlName="description"
                    rows="4"
                  ></textarea>
                </mat-form-field>
              </div>
            </div>
          </div>
        </form>
        <div class="col-12 buttonContainer">
          <button mat-raised-button color="primary" (click)="changetab(1)">
            {{ "buttons.next" | translate }}
          </button>
        </div>
      </mat-tab>
      <mat-tab label="{{ 'incidentDetail.label2' | translate | uppercase }}">
        <mat-spinner *ngIf="loadingMatrix"></mat-spinner>
        <div class="container-fluid" *ngIf="!loadingMatrix">
          <div class="row">
            <div class="col-12 saveIncident">
              <button mat-raised-button color="primary" (click)="saveIncident()">
                {{ "buttons.save" | translate }}
              </button>
            </div>
            <div class="col-12 matrix">
              <div *ngFor="let tactic of matrix">
                <div class="tacticContainer">
                  <div
                    class="tactic"
                    matTooltip="{{ tactic?.value }}"
                    [matTooltipPosition]="'above'"
                  >
                    <span>{{ tactic.name }}</span>
                  </div>
                  <div
                    class="technique"
                    ngClass="{{isTechniqueSelected(technique.id) ? 'selected' : ''}}"
                    *ngFor="let technique of tactic.techniques"
                    matTooltip="{{ technique?.value }}"
                    [matTooltipPosition]="'above'"
                    (click)="selectTechnique(technique.id)"
                  >
                    <span>{{ technique.name }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
